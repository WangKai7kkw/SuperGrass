# load and combine archaea metrics into a data frame
files_arc <- list.files('Results/2-core-metrics_arc', "*matrix.tsv", recursive = TRUE, full.names = TRUE)
# load and combine bacteria metrics into a data frame
files_bac <- list.files('Results/2-core-metrics_bac', "*matrix.tsv", recursive = TRUE, full.names = TRUE)
data_bac <- lapply(files_bac, function(x){read.delim(x, row.names = 1)})
# load and combine archaea metrics into a data frame
files_arc <- list.files('Results/2-core-metrics_arc', "*matrix.tsv", recursive = TRUE, full.names = TRUE)
data_arc <- lapply(files_arc, function(x){read.delim(x, row.names = 1)})
# metadata
metadata <- read.delim('Data/0-exported-metadata/sra-metadata.tsv', row.names = 1, check.names = FALSE)
metadata[, 'Animal_ID'] <- str_extract(string = metadata$Title, pattern = '[0-9][0-9]')
metadata[, 'PCR'] <- ifelse(str_detect(metadata$Title, 'A$'), 'A', 'B')
metadata[, 'Phase'] <- do.call(paste,
data.frame(
str_split_fixed(
string = metadata$`Description [sample]`,
pattern = ' ', n = 3)[, 1:2]))
metadata[, 'Diet'] <- str_split_fixed(string = metadata$`Description [sample]`, pattern = ' ', n = 3)[, 3]
metadata <- metadata[c('Animal_ID', 'PCR', 'Phase', 'Diet')]
metadata[, 'Animal_ID'] <- as.factor(metadata[, 'Animal_ID'])
head(metadata)
data_arc
files_bac
# load and combine bacteria metrics into a data frame
files_bac <- list.files('Results/2-core-metrics_bac', "*matrix.tsv", recursive = TRUE, full.names = TRUE)
data_bac <- lapply(files_bac, function(x){read.delim(x, row.names = 1)})
names(data_bac) <- c("bray_curtis_matrix", "jaccard", "unweighted_unifrac", "weighted_unifrac")
# load and combine archaea metrics into a data frame
files_arc <- list.files('Results/2-core-metrics_arc', "*matrix.tsv", recursive = TRUE, full.names = TRUE)
data_arc <- lapply(files_arc, function(x){read.delim(x, row.names = 1)})
names(data_arc) <- c("bray_curtis_matrix", "jaccard", "unweighted_unifrac", "weighted_unifrac")
files_arc
distance <- data_arc$bray_curtis_matrix
pcoa <- cmdscale(distance, eig = TRUE)
coordinates <- pcoa$points
View(coordinates)
pcoa <- cmdscale(distance, eig = TRUE, k = 4)
coordinates <- pcoa$points
eig <- pcoa$eig
eig
sum(eig)
eig_percentage <- pcoa$eig/sum(pcoa$eig) * 100
eig_percentage
sum(eig_percentage)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 2)
eig_percentage
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
coordinates <- cbind(coordinates, metadata[rownames(coordinates), ])
coordinates <- pcoa$points
coordinates <- data.frame(pcoa$points)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
coordinates <- cbind(coordinates, metadata[rownames(coordinates), ])
coordinates <- data.frame(pcoa$points)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
coordinates <- cbind(coordinates, metadata[rownames(coordinates), ])
ggplot(coordinates, aes(X1, X2))
ggplot(coordinates, aes(X1, X2)) +geom_point()
ggplot(coordinates, aes(X1, X2, color = Phase)) +geom_point()
ggplot(coordinates, aes(X1, X2, color = "Phase")) +geom_point()
ggplot(coordinates, aes_string(X1, X2, color = "Phase")) +geom_point()
ggplot(coordinates, aes_string('X1', 'X2', color = "Phase")) +geom_point()
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point()
color = "Diet"
shape = "Phase"
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point()
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point() +
stat_ellipse()
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point() +
stat_ellipse(aes(group = Phase))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point() +
stat_ellipse(aes(group = Phase, color = Phase))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point() +
stat_ellipse(aes(color = color))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point() +
stat_ellipse(aes_string(color = color))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point() +
stat_ellipse(aes_string(color = color, group = color))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point() +
stat_ellipse(aes_string(color = color, group = color)) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0
color = "Phase"
shape = "Diet"
distance <- data_arc$bray_curtis_matrix
pcoa <- cmdscale(distance, eig = TRUE, k = 4)
coordinates <- data.frame(pcoa$points)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
coordinates <- cbind(coordinates, metadata[rownames(coordinates), ])
plot0 <- ggplot(coordinates, aes_string("X1", "X2", color = color, shape = shape)) +
geom_point() +
stat_ellipse(aes_string(color = color, group = color)) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse() +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse(type = "euclid") +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))]
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse(type = "euclid") +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse() +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse(level = 0.95) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2",  color = color, shape = shape)) +
geom_point() +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"))
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank()
)
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point() +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank(),
legend.key = element_blank()
)
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point(size = 1) +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank(),
legend.key = element_blank()
)
plot0
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point(size = 2) +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank(),
legend.key = element_blank()
)
plot0
vis <- function(distance_matrix, map, color = "", shape = "", point_site = 2){
# color = "Phase"
# shape = "Diet"
# distance_matrix <- data_arc$bray_curtis_matrix
# point_site = 2
pcoa <- cmdscale(distance_matrix, eig = TRUE, k = 4)
coordinates <- data.frame(pcoa$points)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
coordinates <- cbind(coordinates, metadata[rownames(coordinates), ])
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point(size = point_size) +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank(),
legend.key = element_blank()
)
return(plot0)
}
map(data_bac, vis)
map(data_bac, vis, list(metadata, color = "Phase", shape = "Diet"))
map(data_bac, vis, list(map = metadata, color = "Phase", shape = "Diet"))
map(data_bac, vis, list(distance_matrix = data_bac, map = metadata, color = "Phase", shape = "Diet"))
vis(data_bac$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet")
vis(data_bac$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet", point_site = 2)
vis <- function(distance_matrix, map, color = "", shape = "", point_size = 2){
# color = "Phase"
# shape = "Diet"
# distance_matrix <- data_arc$bray_curtis_matrix
# point_size = 2
pcoa <- cmdscale(distance_matrix, eig = TRUE, k = 4)
coordinates <- data.frame(pcoa$points)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
coordinates <- cbind(coordinates, metadata[rownames(coordinates), ])
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point(size = point_size) +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank(),
legend.key = element_blank()
)
return(plot0)
}
vis(data_bac$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet", point_site = 2)
vis(data_bac$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet")
vis(data_bac$jaccard, metadata, color = "Phase", shape = "Diet")
vis(data_bac$unweighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_bac$weighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_bac$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet")
vis(data_bac$jaccard, metadata, color = "Phase", shape = "Diet")
vis(data_bac$unweighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_bac$weighted_unifrac, metadata, color = "Phase", shape = "Diet")
pcoa <- cmdscale(distance_matrix, eig = TRUE, k = 4)
pcoa <- cmdscale(distance, eig = TRUE, k = 4)
coordinates <- data.frame(pcoa$points)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
eig_percentage
vis(data_bac$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet")
vis(data_bac$jaccard, metadata, color = "Phase", shape = "Diet")
vis(data_bac$unweighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_bac$weighted_unifrac, metadata, color = "Phase", shape = "Diet")
pcoa <- cmdscale(distance, eig = TRUE, k = 4)
coordinates <- data.frame(pcoa$points)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
coordinates <- cbind(coordinates, metadata[rownames(coordinates), ])
eig_percentage
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point(size = point_size) +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank(),
legend.key = element_blank()
)
# color = "Phase"
# shape = "Diet"
# distance_matrix <- data_arc$bray_curtis_matrix
point_size = 2
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point(size = point_size) +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank(),
legend.key = element_blank()
)
plot0
vis <- function(distance_matrix, map, color = "", shape = "", point_size = 2){
# color = "Phase"
# shape = "Diet"
# distance_matrix <- data_arc$bray_curtis_matrix
# point_size = 2
pcoa <- cmdscale(distance, eig = TRUE, k = 4)
coordinates <- data.frame(pcoa$points)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
coordinates <- cbind(coordinates, metadata[rownames(coordinates), ])
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point(size = point_size) +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank(),
legend.key = element_blank()
)
return(plot0)
}
vis(data_bac$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet")
vis(data_bac$jaccard, metadata, color = "Phase", shape = "Diet")
vis(data_bac$unweighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_bac$weighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_bac$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet")
vis(data_bac$jaccard, metadata, color = "Phase", shape = "Diet")
vis(data_bac$unweighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_bac$weighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_arc$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet")
vis(data_arc$jaccard, metadata, color = "Phase", shape = "Diet")
vis(data_arc$unweighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_arc$weighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis <- function(distance_matrix, map, color = "", shape = "", point_size = 2){
# color = "Phase"
# shape = "Diet"
# distance_matrix <- data_arc$bray_curtis_matrix
# point_size = 2
pcoa <- cmdscale(distance_matrix, eig = TRUE, k = 4)
coordinates <- data.frame(pcoa$points)
eig_percentage <- round(pcoa$eig/sum(pcoa$eig) * 100, 1)
coordinates <- cbind(coordinates, metadata[rownames(coordinates), ])
plot0 <- ggplot(coordinates, aes_string("X1", "X2", group = color, color = color, shape = shape)) +
geom_point(size = point_size) +
stat_ellipse(level = 0.68) +
labs(x = paste0("PCoA 1: ", eig_percentage[1], "%"),
y = paste0("PCoA 2: ", eig_percentage[2], "%")) +
theme(plot.background = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(linewidth = 1, colour = 'black'),
axis.title = element_text(size = 20, face = "bold", colour = "black"),
axis.text = element_text(size = 18, face = "bold", colour = "black"),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(margin = unit(c(5, 0, 0, 0), 'mm')),
axis.title.y = element_text(margin = unit(c(0, 5, 0, 0), 'mm')),
legend.text = element_text(size = 18, face = "bold", colour = "black"),
legend.title = element_text(size = 18, face = "bold", colour = "black"),
legend.background = element_blank(),
legend.key = element_blank()
)
return(plot0)
}
vis(data_bac$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet")
vis(data_bac$jaccard, metadata, color = "Phase", shape = "Diet")
vis(data_bac$unweighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_bac$weighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_arc$bray_curtis_matrix, metadata, color = "Phase", shape = "Diet")
vis(data_arc$jaccard, metadata, color = "Phase", shape = "Diet")
vis(data_arc$unweighted_unifrac, metadata, color = "Phase", shape = "Diet")
vis(data_arc$weighted_unifrac, metadata, color = "Phase", shape = "Diet")
?adonis
adonis2(data_arc$bray_curtis_matrix ~ Phase * Diet, metadata)
metadata_bac <- metadata[rownames(data_bac$bray_curtis_matrix), ]
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac)
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac, by = "margin")
metadata_bac <- metadata[rownames(data_bac$bray_curtis_matrix), ]
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac, by = "terms")
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac, by = "margin")
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac, by = "onedf")
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac, by = NULL)
metadata_bac <- metadata[rownames(data_bac$bray_curtis_matrix), ]
adonis2(data_bac$bray_curtis_matrix ~ Phase + Diet, metadata_bac, by = "terms")
adonis2(data_bac$bray_curtis_matrix ~ Phase + Diet, metadata_bac, by = "margin")
adonis2(data_bac$bray_curtis_matrix ~ Phase + Diet, metadata_bac, by = "onedf")
View(dune)
View(dune.env)
dat
metaMDS(distance = data_arc$bray_curtis_matrix)
metaMDS(data_arc$bray_curtis_matrix )
plot(metaMDS(data_arc$bray_curtis_matrix ))
with(metadata_bac, ordiellipse(metaMDS(data_bac$bray_curtis_matrix, trace = F), Phase, kind = "ehull", label = TRUE))
with(metadata_bac, ordiellipse(metaMDS(data_bac$bray_curtis_matrix, trace = F, lty = 3, col = 'red'), Phase, kind = "ehull", label = TRUE))
with(metadata_bac, adonis2(data_bac$bray_curtis_matrix ~ Diet, data = metadata_bac, strata = Phase))
adonis2(data_bac$bray_curtis_matrix ~ Diet, metadata_bac, strata = Phase)
adonis2(data_bac$bray_curtis_matrix ~ Phase + Diet, metadata_bac)
with(metadata_bac, adonis2(data_bac$bray_curtis_matrix ~ Diet, metadata_bac, strata = Phase))
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac)
with(metadata_bac, adonis2(data_bac$bray_curtis_matrix ~ Diet, metadata_bac, strata = Phase))
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac, by = 'onedf')
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac)
with(metadata_bac, adonis2(data_bac$bray_curtis_matrix ~ Diet, metadata_bac, strata = Phase))
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac)
adonis2(data_bac$jaccard ~ Phase * Diet, metadata_bac)
adonis2(data_bac$unweighted_unifrac ~ Phase * Diet, metadata_bac)
adonis2(data_bac$weighted_unifrac ~ Phase * Diet, metadata_bac)
with(metadata_bac, adonis2(data_bac$bray_curtis_matrix ~ Diet, metadata_bac, strata = Phase))
with(metadata_bac, adonis2(data_bac$jaccard ~ Diet, metadata_bac, strata = Phase))
with(metadata_bac, adonis2(data_bac$unweighted_unifrac ~ Diet, metadata_bac, strata = Phase))
with(metadata_bac, adonis2(data_bac$weighted_unifrac ~ Diet, metadata_bac, strata = Phase))
metadata_arc <- metadata[rownames(data_arc$bray_curtis_matrix), ]
adonis2(data_arc$bray_curtis_matrix ~ Phase * Diet, metadata_arc)
adonis2(data_arc$jaccard ~ Phase * Diet, metadata_arc)
adonis2(data_arc$unweighted_unifrac ~ Phase * Diet, metadata_arc)
adonis2(data_arc$weighted_unifrac ~ Phase * Diet, metadata_arc)
with(metadata_arc, adonis2(data_arc$bray_curtis_matrix ~ Diet, metadata_arc, strata = Phase))
with(metadata_arc, adonis2(data_arc$jaccard ~ Diet, metadata_arc, strata = Phase))
with(metadata_arc, adonis2(data_arc$unweighted_unifrac ~ Diet, metadata_arc, strata = Phase))
with(metadata_arc, adonis2(data_arc$weighted_unifrac ~ Diet, metadata_arc, strata = Phase))
adonis2(data_bac$bray_curtis_matrix ~ Phase * Diet, metadata_bac)
adonis2(data_bac$jaccard ~ Phase * Diet, metadata_bac)
adonis2(data_bac$unweighted_unifrac ~ Phase * Diet, metadata_bac)
adonis2(data_bac$weighted_unifrac ~ Phase * Diet, metadata_bac)
